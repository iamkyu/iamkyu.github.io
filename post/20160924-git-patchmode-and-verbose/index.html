<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=google-site-verification content="<google-site-verification-code>"><meta name=author content="남규진"><meta name=description content="남규진의 개발 블로그"><meta name=keywords content="java,spring framework"><meta name=referrer content="always"><title>GIT 더 꼼꼼하게 커밋하기 - namkyujin.com</title><link rel=stylesheet type=text/css href=/css/main.css><link rel=icon href=/logo/favicon.ico type=image/x-icon></head><body><header><div><h1><a href=https://iamkyu.github.io>namkyujin.com</a></h1></div><nav><a href=/>blog</a><a href=https://github.com/iamkyu/TIL/blob/master/books/books.md>books</a><a href=/about/>about</a></nav></header><main><article><div class=meta><div>2016-09-24</div><div><span><a href=https://iamkyu.github.io/tags/git/>#git</a></span></div></div><div class=content><h1 id=git-더-꼼꼼하게-커밋하기>GIT 더 꼼꼼하게 커밋하기</h1><p>어쪄면 코드(Code)를 다루는 작업은 <code>fetch</code>로 시작해서 <code>commit</code>으로 끝난다. 버전관리시스템을 통해 여러명의 팀원이 협업을 한다면 아침에 출근해서 원격저장소와 소스코드의 버전(Sync)을 맞추고 작업을 진행한다. 그리고 내 작업량을 모두 해치우고 커밋을 하고 나서야 한숨 돌릴 수 있다.</p><blockquote><p>Git에서는 로컬 저장소에 소스코드를 올리는 일을 <code>Commit</code>, 받는 일을 <code>Fetch</code> 라고 하고 원격 저장소에 올리는 일은 <code>Push</code> 받는 일은 <code>Pull</code> 라고 하지만, 편의상 이 글에서는 <code>Commit</code> 과 <code>Fetch</code> 라는 용어만 사용한다.</p></blockquote><p>커밋이라는 행위는 내 코드, 내가 작성한 코드가 나만의 통제를 벗어나는 것이다. 그래서 나는 커밋 전에는 가능한 꼼꼼하게 다시 한번 보려고 노력한다. 내 코드를 내 스스로 다시 한번 리뷰하는 것이다. 통합개발도구(IDE)에서는 현재 원격저장소에 있는 코드와 내가 가지고 있는 코드의 차이(diff) 를 구분하기 쉽게 보여 준다.</p><p><img src="https://lh3.googleusercontent.com/OZGh8oOeb0sYpWX9beOZ6Jv7veO1QRkNt4e7xot10Ve7sNLMvgp_BwyX-XA7uTl51LmBrsNzBar8LveNI4jGAWCP6bcJsDmgTHAMsOz264_8G9fDR-94qA97VyPLUw3PFuPpCwyiRAffgGVr8WsQegNbUHrpUmzxMgjG0Kc_4fhWUoYBB7VbWsv2ecNieKKHxdDgAwlJm_AFpsA3NMYGNG2e69u7SbokhbACZMBmekVeKMaHQMrWm3bOGeqjmLNCCad11pFMG39feqWTvlaLYw26P_XxHDS6_MnH1Ygoqx7pHHQRO4cPnMrGnAThahbOARfTKZd2vmImr3aNMRF5dqS93h4mlj5SH840aA1s8EF4-i_N5RNtstn2cqoEivnl2hg51rplqzI0a19llKdRNxBHAa7oFXkpiVXn5TRJhkZT8um2Yj3jncjY-Nh-APt8dcLfiB_wWKeJVKEg1v7u9dt621FBvE2AtjSOVeVSSYlkbvfzXRJODmKT5b6fArbQ9YZnZcRLXAmioLUpyaWhkqelCP7gRjsFa3AWCNWSB9klXblZs3A1Y10QmNLqQPglRFL87AioTtaQOutJ7JiFGTkEfdRTV_-PFT8UNr_rbOpkZ83Y=w1236-h522-no" alt=git-patchmode-and-verbose-img1></p><p>여기서 한 가지 아쉬운 점은, 내가 변경한 소스들을 파일 단위로 하나 하나 열어보며 비교를 해야 한다는 것이다. <img src="https://lh3.googleusercontent.com/wLg9aBOrX4QMlwCwyqR-vmYb2WzrQ9X-wVQwCJxhNnZP_7M9dcDOW0dHo1dOpFLafQ2OsJzVz-CGGOyMbcyIAuy58UJlJe7wDK_swE6Br112LyBgCwjnFR-hXyqYo5eyey8RurV8Up8tIDARa3ZTWDNvyM8Ub70H6KM-W2MmIy5OtmANDETbyfNuT_LSfZpTbtfkVBLl3PEyoxBy4S7PSmYsz687aEHgqlYG-omz7mnz8GY6w7ojGNJKjNRDeP8YMiARxuxTnhcKEIJ9mzwDgUIhCzTuL3sMypCNcZrj7gW0pxt-D-0bCV2a92S8a6EJYNGtwnR9oFHIB1SqiOh9eeZjbKvUbghfMKgY46sZIL48hGvBBzplVc2oZA6z9rI9b0FkJntCgPwosgDdqBpWWurqfG_v-gwgtHZv0mxJkeXDQwJcFDfhgb3e0CjLdYrWl9zU5psCMAzV8u-13YsU1D1sq31-CDP9pZRFG_tpURhSHT2lztgaF_JIpe8hOxOxt8S3vPkHvEBQGjf-61NoaRuKf7yYVOnwj8kbpV0RkWvHXZAklPpoql7XqENCN-AyWe7KJDIhw4RA27j6y9fcuny31Dv0zyAcDM6fjqTC6y2W95uD=w786-h281-no" alt=git-patchmode-and-verbose-img2></p><p>만약 10개의 소스파일을 수정했다면 10개 파일을 클릭해서 열어봐야 하고, 20개의 소스 파일을 수정 했다면 20개를 열어 봐야 하는 것이다. 굉장히 귀찮은 일이다.</p><h2 id=patch-mode>Patch Mode</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>$ git add -p
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#6272a4># 또는</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>$ git add --patch
</code></pre></div><p>패치모드는 추척되고 있는 소스 중, 변경 된 모든 것을 추적하여 변경 된 덩어리(hunk) 단위로 돌아가며 보여준다.</p><p><img src="https://lh3.googleusercontent.com/GzuwSesOtqYXYyOZ7kb0PI4tvtRh9Xi91dz_II8hoSUgU7-4iNAAYA94gbwTD1cRkXmHhdN6WAgxW6o0000tjI0VXCN6giKLoh4qN5sgbFcG3y1sysFqFAEqLmgBf8cM9yg51oPgg0njdA-bV0x_fRaHsB1ZvWYF75V7nsYWg93NvztB268IWhSJbl_S7RbHcN2mWZcY6M3stjjAP7HLRpMX43vTfhX9-iMatENshDE-0pX8C720aqXvFbhLetKshJ1im5u8_R4aAaXckDQkmS7MgYp8Gjz051_9OuE5hp09P_UKM5lrf5ocNqHmKb71q-D-22wiCCezNWTvifRVmBswLpoHQGSC6av1DpAGFFI2UnQjV_97HTwmjuPDpxSSl3FI0EKS3qZqj992gVAC_1YsTklVZ7nnHz3RAONKjmlLWi6ZIAqENAQY8sRuULsINmoZTIpry8VCFfR_9PbjYm8xc7NVaRx2Z_avw2IavrG1qqzCgUUQgCbfblcEiqMFJGW-2klo_YJWrL4c8PeZqXC0oo2LLbl5GDfnK49LOR2G3GlmVEMrn6djwJ5CwAtHXQnq94Z3P-8-0b4ydPxERNKv77_PG4uksJOjLmFk9bus7DQz=w703-h305-no" alt=git-patchmode-and-verbose-img3></p><p>글로는 잘 이해가 안갈텐데, 위와 같이 변경 된 (<code>+</code> 또는 <code>-</code>) 부분만을 보여주면서 모든 소스 파일들의 변화를 추적한다.</p><p>직접 해보는 것이 좋은 방법이지만, 환경이 여의치 않다면 <a href=https://www.youtube.com/user/johnkarydotnet>Intro to git add patch mode tutorial</a> 영상을 보면 패치모드가 어떤식으로 동작하는지 이해할 수 있을 것이다.</p><p>그리고 이렇게 보여주는 변경 변경 덩어리마다 어떻게 처리할 지를(스테이지에 올릴지, 그냥 넘어갈 것인지를) 선택해주면 된다.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>Stage this hunk <span style=color:#ff79c6>[</span>y,n,q,a,d,/,j,J,g,s,e,?<span style=color:#ff79c6>]</span>?
</code></pre></div><p>위와 같이 선택지가 12가지 인데, 각각의 옵션들에 대한 설명은 <a href=http://stackoverflow.com/questions/1085162/commit-only-part-of-a-file-in-git>stackoverflow.com에 올라온 관련 글</a>에서 확인할 수 있다.</p><h2 id=commit---verbose>commit &ndash;verbose</h2><p>패치모드를 통해 변경 된 코드 덩어리들을 빠르게 리뷰 할 수 있다. 그리고 이 과정에서 스테이징 할 소스코드를 선택했을 것이다. 이제 커밋을 할 차례. 하지만 마지막 커밋을 하기 전 한번 더 점검 과정을 거친다.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span>$ git commit -v
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span style=color:#6272a4># 또는</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span>$ git commit --verbose
</code></pre></div><p>위와 같은 커맨드를 입력하면 편집기가 열리면서 커밋 메세지를 작성할 수 있고, 수정 된 코드들을 다시 한번 리뷰하고 편집기에서 바로 수정할 수 도 있다.</p><p>코드를 작성하거나 수정 후 당연히 꼼꼼히 확인하겠지만 사람이다 보니 놓치는 부분이 있기 마련이다. 이를 방지하기 위해 두 번의 리뷰 과정을 다시 거치면서 마침내 코드를 커밋하게 되는 것이다. 조금 번거롭긴 하지만 좋은 습관이라 생각 된다. 나도 항상 이런 습관을 유지하도록 노력해야겠다.</p></div><div class=side style=position:fixed;right:50px;max-width:255px;overflow:auto;top:120px;width:220px;bottom:90px><div class=toc><div class=page-header><strong>Table of contents</strong></div><div id=page-scrollspy class=toc-nav><ul class=nav><li class=nav-item><a class="nav-link text-left" href=#git-%eb%8d%94-%ea%bc%bc%ea%bc%bc%ed%95%98%ea%b2%8c-%ec%bb%a4%eb%b0%8b%ed%95%98%ea%b8%b0>GIT 더 꼼꼼하게 커밋하기</a></li></ul><ul class=nav><ul class=nav><li class=nav-item><a class="nav-link text-left" href=#patch-mode>Patch Mode</a></li></ul></ul><ul class=nav><ul class=nav><li class=nav-item><a class="nav-link text-left" href=#commit---verbose>commit –verbose</a></li></ul></ul></div></div></div><script src=https://utteranc.es/client.js repo=iamkyu/iamkyu.github.io issue-term=title label=comment theme=github-light crossorigin=anonymous async></script></article></main><footer><div><div>&copy; 2021 Kyujin Nam. <a href=https://creativecommons.org/licenses/by/4.0/deed.ko>CC-BY-4.0</a><p>Powered by <a href=https://gohugo.io/>Hugo</a> with <a href=https://github.com/yanlinlin82/simple-style>Simple-Style</a></div></div></footer><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-87267111-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><a href=https://github.com/iamkyu/iamkyu.github.io class=github-corner aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media(max-width:800px){.github-corner{display:none}}</style></body></html>