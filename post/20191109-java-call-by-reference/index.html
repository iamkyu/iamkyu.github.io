<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=google-site-verification content="<google-site-verification-code>"><meta name=author content="남규진"><meta name=description content="남규진의 개발 블로그"><meta name=keywords content="java,spring framework"><meta name=referrer content="always"><title>Java, Call By Reference 에 대한 오해 - namkyujin.com</title><link rel=stylesheet type=text/css href=/css/main.css><link rel=icon href=/logo/favicon.ico type=image/x-icon></head><body><header><div><h1><a href=https://iamkyu.github.io>namkyujin.com</a></h1></div><nav><a href=/>blog</a><a href=https://github.com/iamkyu/TIL/blob/master/books/books.md>books</a><a href=/about/>about</a></nav></header><main><article><div class=meta><div>2019-11-09</div><div><span><a href=https://iamkyu.github.io/tags/java/>#java</a></span></div></div><div class=content><h1 id=java-call-by-reference-에-대한-오해>Java, Call By Reference 에 대한 오해</h1><p>이제까지 기본형은 Call By Value, 참조형은 Call By Reference로 막연히 알고 있었다. 그런데 생성자나 메서드를 통해 전달된 값을 사용할 때 오해하고 있는 부분이 있어 이를 정리한다.</p><p>결론부터 얘기하자면</p><blockquote><p>Reference data type parameters, such as objects, are also passed into methods by value.</p></blockquote><p>오라클의 Java Tutorials 문서 중 Passing Information to a Method or a Constructor를 살펴보면 위와 같이 서술되어 있다. 즉, 참조형 데이터 타입 역시 값으로 메소드에 전달된다는 것. 몇 가지 예제와 함께 살펴보자. 먼저, 예제에 사용할 Message 클래스를 정의한다.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>class</span> <span style=color:#50fa7b>Message</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span>    <span style=color:#8be9fd;font-style:italic>private</span> String contents<span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#50fa7b>Message</span><span style=color:#ff79c6>(</span>String contents<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>        <span style=color:#ff79c6>this</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>contents</span> <span style=color:#ff79c6>=</span> contents<span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>    <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>changeContents</span><span style=color:#ff79c6>(</span>String contents<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>        <span style=color:#ff79c6>this</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>contents</span> <span style=color:#ff79c6>=</span> contents<span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>    <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span>    <span style=color:#8be9fd;font-style:italic>public</span> String <span style=color:#50fa7b>getContents</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span>        <span style=color:#ff79c6>return</span> contents<span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span>    <span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#ff79c6>}</span>
</code></pre></div><p>첫 번째로, Call By Reference 예제에 많이 사용되는 인스턴스 참조를 전달하고 해당 인스턴스의 속성을 변경하는 코드.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span>@Test
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>caller</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>    Message message <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> Message<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;hello&#34;</span><span style=color:#ff79c6>)</span><span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>    callee<span style=color:#ff79c6>(</span>message<span style=color:#ff79c6>)</span><span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>    assertThat<span style=color:#ff79c6>(</span>message<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getContents</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>)</span><span style=color:#ff79c6>)</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>isEqualTo</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;bye&#34;</span><span style=color:#ff79c6>)</span><span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span>    <span style=color:#6272a4>// Test passed
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#6272a4></span><span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span style=color:#8be9fd;font-style:italic>private</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>callee</span><span style=color:#ff79c6>(</span>Message message<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span>    message<span style=color:#ff79c6>.</span><span style=color:#50fa7b>changeContents</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;bye&#34;</span><span style=color:#ff79c6>)</span><span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#ff79c6>}</span>
</code></pre></div><p>앞서 인용한 오라클 문서에 이와 관련해 언급되어 있다.</p><blockquote><p>the values of the object&rsquo;s fields can be changed in the method, if they have the proper access level.</p></blockquote><p>즉, callee 에서 전달받은 참조형의 속성에 직접 접근할 수 있거나 속성을 변경할 수 있는 메서드가 제공된다면 속성을 변경할 수 있다. 이때, caller 나 callee 모든 같음 참조 주소를 가지고 있기 때문에 이 속성의 변경에 양쪽 모두 영향을 받는다.</p><p>반면, 아래 두 번째 예제는 callee 에서 전달받은 message에 새로운 인스턴스를 할당해버렸다. 그 후 caller에서 <code>message.getContents()</code> 로 속성을 확인하면 “hello” 일까 “bye” 일까?</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span>@Test
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>caller</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span>    Message message <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> Message<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;hello&#34;</span><span style=color:#ff79c6>)</span><span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span>    callee<span style=color:#ff79c6>(</span>message<span style=color:#ff79c6>)</span><span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>    <span style=color:#6272a4>// message.getContents() 는 hello? bye?
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#6272a4></span><span style=color:#ff79c6>}</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span style=color:#8be9fd;font-style:italic>private</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>callee</span><span style=color:#ff79c6>(</span>Message message<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>    message <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> Message<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;bye&#34;</span><span style=color:#ff79c6>)</span><span style=color:#ff79c6>;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#ff79c6>}</span>
</code></pre></div><p>정답은 “hello” 다. 사실 조금만 생각해보면 간단한 문제인데, 나를 헷갈리게 했던 포인트다.
앞서 오라클 문서에서 언급했듯 참조형 데이터 타입 역시 값으로 전달된다고 했다. 이때 이 값은 “참조 주소” 이다.
근데 이 값을 사용하지 않고 않고 다른 “참조 주소”가 할당되어 버렸기 때문에 caller 와 callee 는 서로 다른 message 인스턴스에 접근하고 있다.</p><p>이를 명확하게 구분하자면 자바에서 생성자나 메서드는 항상 Pass By Value, 객체나 배열의 경우 이 값이 참조 주소이고 이를 통해 Call By Reference가 일어난다가 정확한 설명이 아닐까?</p><h2 id=참고>참고</h2><ul><li><a href=https://docs.oracle.com/javase/tutorial/java/javaOO/arguments.html>Oracle - The Java™ Tutorials : Passing Information to a Method or a Constructor</a></li></ul></div><div class=side style=position:fixed;right:50px;max-width:255px;overflow:auto;top:120px;width:220px;bottom:90px><div class=toc><div class=page-header><strong>Table of contents</strong></div><div id=page-scrollspy class=toc-nav><ul class=nav><li class=nav-item><a class="nav-link text-left" href=#java-call-by-reference-%ec%97%90-%eb%8c%80%ed%95%9c-%ec%98%a4%ed%95%b4>Java, Call By Reference 에 대한 오해</a></li></ul><ul class=nav><ul class=nav><li class=nav-item><a class="nav-link text-left" href=#%ec%b0%b8%ea%b3%a0>참고</a></li></ul></ul></div></div></div><script src=https://utteranc.es/client.js repo=iamkyu/iamkyu.github.io issue-term=title label=comment theme=github-light crossorigin=anonymous async></script></article></main><footer><div><div>&copy; 2020 Kyujin Nam. <a href=https://creativecommons.org/licenses/by/4.0/deed.ko>CC-BY-4.0</a><p>Powered by <a href=https://gohugo.io/>Hugo</a> with <a href=https://github.com/yanlinlin82/simple-style>Simple-Style</a></div></div></footer><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-87267111-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><a href=https://github.com/iamkyu/iamkyu.github.io class=github-corner aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media(max-width:800px){.github-corner{display:none}}</style></body></html>